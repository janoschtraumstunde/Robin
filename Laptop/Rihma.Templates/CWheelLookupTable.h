#include <avr/pgmspace.h>

// left, right, back (and sin)
const prog_int16_t wheelSpeeds[] PROGMEM = {
	14188, -14188, 0, // 0
	14329, -14043, -285, // 1
	14466, -13894, -571, // 2
	14598, -13740, -857, // 3
	14725, -13582, -1142, // 4
	14848, -13420, -1427, // 5
	14967, -13254, -1712, // 6
	15081, -13084, -1996, // 7
	15190, -12910, -2280, // 8
	15295, -12732, -2563, // 9
	15395, -12550, -2845, // 10
	15491, -12365, -3126, // 11
	15582, -12175, -3406, // 12
	15668, -11982, -3685, // 13
	15749, -11785, -3963, // 14
	15825, -11585, -4240, // 15
	15897, -11381, -4516, // 16
	15964, -11173, -4790, // 17
	16025, -10963, -5062, // 18
	16082, -10748, -5334, // 19
	16135, -10531, -5603, // 20
	16182, -10310, -5871, // 21
	16224, -10086, -6137, // 22
	16261, -9860, -6401, // 23
	16294, -9630, -6663, // 24
	16321, -9397, -6924, // 25
	16344, -9161, -7182, // 26
	16361, -8923, -7438, // 27
	16374, -8682, -7691, // 28
	16381, -8438, -7943, // 29
	16384, -8192, -8191, // 30
	16381, -7943, -8438, // 31
	16374, -7691, -8682, // 32
	16361, -7438, -8923, // 33
	16344, -7182, -9161, // 34
	16321, -6924, -9397, // 35
	16294, -6663, -9630, // 36
	16261, -6401, -9860, // 37
	16224, -6137, -10086, // 38
	16182, -5871, -10310, // 39
	16135, -5603, -10531, // 40
	16082, -5334, -10748, // 41
	16025, -5062, -10963, // 42
	15964, -4790, -11173, // 43
	15897, -4516, -11381, // 44
	15825, -4240, -11585, // 45
	15749, -3963, -11785, // 46
	15668, -3685, -11982, // 47
	15582, -3406, -12175, // 48
	15491, -3126, -12365, // 49
	15395, -2845, -12550, // 50
	15295, -2563, -12732, // 51
	15190, -2280, -12910, // 52
	15081, -1996, -13084, // 53
	14967, -1712, -13254, // 54
	14848, -1427, -13420, // 55
	14725, -1142, -13582, // 56
	14598, -857, -13740, // 57
	14466, -571, -13894, // 58
	14329, -285, -14043, // 59
	14188, 0, -14188, // 60
	14043, 285, -14329, // 61
	13894, 571, -14466, // 62
	13740, 857, -14598, // 63
	13582, 1142, -14725, // 64
	13420, 1427, -14848, // 65
	13254, 1712, -14967, // 66
	13084, 1996, -15081, // 67
	12910, 2280, -15190, // 68
	12732, 2563, -15295, // 69
	12550, 2845, -15395, // 70
	12365, 3126, -15491, // 71
	12175, 3406, -15582, // 72
	11982, 3685, -15668, // 73
	11785, 3963, -15749, // 74
	11585, 4240, -15825, // 75
	11381, 4516, -15897, // 76
	11173, 4790, -15964, // 77
	10963, 5062, -16025, // 78
	10748, 5334, -16082, // 79
	10531, 5603, -16135, // 80
	10310, 5871, -16182, // 81
	10086, 6137, -16224, // 82
	9860, 6401, -16261, // 83
	9630, 6663, -16294, // 84
	9397, 6924, -16321, // 85
	9161, 7182, -16344, // 86
	8923, 7438, -16361, // 87
	8682, 7691, -16374, // 88
	8438, 7943, -16381, // 89
	8192, 8191, -16384, // 90
	7943, 8438, -16381, // 91
	7691, 8682, -16374, // 92
	7438, 8923, -16361, // 93
	7182, 9161, -16344, // 94
	6924, 9397, -16321, // 95
	6663, 9630, -16294, // 96
	6401, 9860, -16261, // 97
	6137, 10086, -16224, // 98
	5871, 10310, -16182, // 99
	5603, 10531, -16135, // 100
	5334, 10748, -16082, // 101
	5062, 10963, -16025, // 102
	4790, 11173, -15964, // 103
	4516, 11381, -15897, // 104
	4240, 11585, -15825, // 105
	3963, 11785, -15749, // 106
	3685, 11982, -15668, // 107
	3406, 12175, -15582, // 108
	3126, 12365, -15491, // 109
	2845, 12550, -15395, // 110
	2563, 12732, -15295, // 111
	2280, 12910, -15190, // 112
	1996, 13084, -15081, // 113
	1712, 13254, -14967, // 114
	1427, 13420, -14848, // 115
	1142, 13582, -14725, // 116
	857, 13740, -14598, // 117
	571, 13894, -14466, // 118
	285, 14043, -14329, // 119
	0, 14188, -14188, // 120
	-285, 14329, -14043, // 121
	-571, 14466, -13894, // 122
	-857, 14598, -13740, // 123
	-1142, 14725, -13582, // 124
	-1427, 14848, -13420, // 125
	-1712, 14967, -13254, // 126
	-1996, 15081, -13084, // 127
	-2280, 15190, -12910, // 128
	-2563, 15295, -12732, // 129
	-2845, 15395, -12550, // 130
	-3126, 15491, -12365, // 131
	-3406, 15582, -12175, // 132
	-3685, 15668, -11982, // 133
	-3963, 15749, -11785, // 134
	-4240, 15825, -11585, // 135
	-4516, 15897, -11381, // 136
	-4790, 15964, -11173, // 137
	-5062, 16025, -10963, // 138
	-5334, 16082, -10748, // 139
	-5603, 16135, -10531, // 140
	-5871, 16182, -10310, // 141
	-6137, 16224, -10086, // 142
	-6401, 16261, -9860, // 143
	-6663, 16294, -9630, // 144
	-6924, 16321, -9397, // 145
	-7182, 16344, -9161, // 146
	-7438, 16361, -8923, // 147
	-7691, 16374, -8682, // 148
	-7943, 16381, -8438, // 149
	-8192, 16384, -8191, // 150
	-8438, 16381, -7943, // 151
	-8682, 16374, -7691, // 152
	-8923, 16361, -7438, // 153
	-9161, 16344, -7182, // 154
	-9397, 16321, -6924, // 155
	-9630, 16294, -6663, // 156
	-9860, 16261, -6401, // 157
	-10086, 16224, -6137, // 158
	-10310, 16182, -5871, // 159
	-10531, 16135, -5603, // 160
	-10748, 16082, -5334, // 161
	-10963, 16025, -5062, // 162
	-11173, 15964, -4790, // 163
	-11381, 15897, -4516, // 164
	-11585, 15825, -4240, // 165
	-11785, 15749, -3963, // 166
	-11982, 15668, -3685, // 167
	-12175, 15582, -3406, // 168
	-12365, 15491, -3126, // 169
	-12550, 15395, -2845, // 170
	-12732, 15295, -2563, // 171
	-12910, 15190, -2280, // 172
	-13084, 15081, -1996, // 173
	-13254, 14967, -1712, // 174
	-13420, 14848, -1427, // 175
	-13582, 14725, -1142, // 176
	-13740, 14598, -857, // 177
	-13894, 14466, -571, // 178
	-14043, 14329, -285, // 179
	-14188, 14188, 0, // 180
	-14329, 14043, 285, // 181
	-14466, 13894, 571, // 182
	-14598, 13740, 857, // 183
	-14725, 13582, 1142, // 184
	-14848, 13420, 1427, // 185
	-14967, 13254, 1712, // 186
	-15081, 13084, 1996, // 187
	-15190, 12910, 2280, // 188
	-15295, 12732, 2563, // 189
	-15395, 12550, 2845, // 190
	-15491, 12365, 3126, // 191
	-15582, 12175, 3406, // 192
	-15668, 11982, 3685, // 193
	-15749, 11785, 3963, // 194
	-15825, 11585, 4240, // 195
	-15897, 11381, 4516, // 196
	-15964, 11173, 4790, // 197
	-16025, 10963, 5062, // 198
	-16082, 10748, 5334, // 199
	-16135, 10531, 5603, // 200
	-16182, 10310, 5871, // 201
	-16224, 10086, 6137, // 202
	-16261, 9860, 6401, // 203
	-16294, 9630, 6663, // 204
	-16321, 9397, 6924, // 205
	-16344, 9161, 7182, // 206
	-16361, 8923, 7438, // 207
	-16374, 8682, 7691, // 208
	-16381, 8438, 7943, // 209
	-16384, 8192, 8192, // 210
	-16381, 7943, 8438, // 211
	-16374, 7691, 8682, // 212
	-16361, 7438, 8923, // 213
	-16344, 7182, 9161, // 214
	-16321, 6924, 9397, // 215
	-16294, 6663, 9630, // 216
	-16261, 6401, 9860, // 217
	-16224, 6137, 10086, // 218
	-16182, 5871, 10310, // 219
	-16135, 5603, 10531, // 220
	-16082, 5334, 10748, // 221
	-16025, 5062, 10963, // 222
	-15964, 4790, 11173, // 223
	-15897, 4516, 11381, // 224
	-15825, 4240, 11585, // 225
	-15749, 3963, 11785, // 226
	-15668, 3685, 11982, // 227
	-15582, 3406, 12175, // 228
	-15491, 3126, 12365, // 229
	-15395, 2845, 12550, // 230
	-15295, 2563, 12732, // 231
	-15190, 2280, 12910, // 232
	-15081, 1996, 13084, // 233
	-14967, 1712, 13254, // 234
	-14848, 1427, 13420, // 235
	-14725, 1142, 13582, // 236
	-14598, 857, 13740, // 237
	-14466, 571, 13894, // 238
	-14329, 285, 14043, // 239
	-14188, 0, 14188, // 240
	-14043, -285, 14329, // 241
	-13894, -571, 14466, // 242
	-13740, -857, 14598, // 243
	-13582, -1142, 14725, // 244
	-13420, -1427, 14848, // 245
	-13254, -1712, 14967, // 246
	-13084, -1996, 15081, // 247
	-12910, -2280, 15190, // 248
	-12732, -2563, 15295, // 249
	-12550, -2845, 15395, // 250
	-12365, -3126, 15491, // 251
	-12175, -3406, 15582, // 252
	-11982, -3685, 15668, // 253
	-11785, -3963, 15749, // 254
	-11585, -4240, 15825, // 255
	-11381, -4516, 15897, // 256
	-11173, -4790, 15964, // 257
	-10963, -5062, 16025, // 258
	-10748, -5334, 16082, // 259
	-10531, -5603, 16135, // 260
	-10310, -5871, 16182, // 261
	-10086, -6137, 16224, // 262
	-9860, -6401, 16261, // 263
	-9630, -6663, 16294, // 264
	-9397, -6924, 16321, // 265
	-9161, -7182, 16344, // 266
	-8923, -7438, 16361, // 267
	-8682, -7691, 16374, // 268
	-8438, -7943, 16381, // 269
	-8192, -8191, 16384, // 270
	-7943, -8438, 16381, // 271
	-7691, -8682, 16374, // 272
	-7438, -8923, 16361, // 273
	-7182, -9161, 16344, // 274
	-6924, -9397, 16321, // 275
	-6663, -9630, 16294, // 276
	-6401, -9860, 16261, // 277
	-6137, -10086, 16224, // 278
	-5871, -10310, 16182, // 279
	-5603, -10531, 16135, // 280
	-5334, -10748, 16082, // 281
	-5062, -10963, 16025, // 282
	-4790, -11173, 15964, // 283
	-4516, -11381, 15897, // 284
	-4240, -11585, 15825, // 285
	-3963, -11785, 15749, // 286
	-3685, -11982, 15668, // 287
	-3406, -12175, 15582, // 288
	-3126, -12365, 15491, // 289
	-2845, -12550, 15395, // 290
	-2563, -12732, 15295, // 291
	-2280, -12910, 15190, // 292
	-1996, -13084, 15081, // 293
	-1712, -13254, 14967, // 294
	-1427, -13420, 14848, // 295
	-1142, -13582, 14725, // 296
	-857, -13740, 14598, // 297
	-571, -13894, 14466, // 298
	-285, -14043, 14329, // 299
	0, -14188, 14188, // 300
	285, -14329, 14043, // 301
	571, -14466, 13894, // 302
	857, -14598, 13740, // 303
	1142, -14725, 13582, // 304
	1427, -14848, 13420, // 305
	1712, -14967, 13254, // 306
	1996, -15081, 13084, // 307
	2280, -15190, 12910, // 308
	2563, -15295, 12732, // 309
	2845, -15395, 12550, // 310
	3126, -15491, 12365, // 311
	3406, -15582, 12175, // 312
	3685, -15668, 11982, // 313
	3963, -15749, 11785, // 314
	4240, -15825, 11585, // 315
	4516, -15897, 11381, // 316
	4790, -15964, 11173, // 317
	5062, -16025, 10963, // 318
	5334, -16082, 10748, // 319
	5603, -16135, 10531, // 320
	5871, -16182, 10310, // 321
	6137, -16224, 10086, // 322
	6401, -16261, 9860, // 323
	6663, -16294, 9630, // 324
	6924, -16321, 9397, // 325
	7182, -16344, 9161, // 326
	7438, -16361, 8923, // 327
	7691, -16374, 8682, // 328
	7943, -16381, 8438, // 329
	8192, -16384, 8192, // 330
	8438, -16381, 7943, // 331
	8682, -16374, 7691, // 332
	8923, -16361, 7438, // 333
	9161, -16344, 7182, // 334
	9397, -16321, 6924, // 335
	9630, -16294, 6663, // 336
	9860, -16261, 6401, // 337
	10086, -16224, 6137, // 338
	10310, -16182, 5871, // 339
	10531, -16135, 5603, // 340
	10748, -16082, 5334, // 341
	10963, -16025, 5062, // 342
	11173, -15964, 4790, // 343
	11381, -15897, 4516, // 344
	11585, -15825, 4240, // 345
	11785, -15749, 3963, // 346
	11982, -15668, 3685, // 347
	12175, -15582, 3406, // 348
	12365, -15491, 3126, // 349
	12550, -15395, 2845, // 350
	12732, -15295, 2563, // 351
	12910, -15190, 2280, // 352
	13084, -15081, 1996, // 353
	13254, -14967, 1712, // 354
	13420, -14848, 1427, // 355
	13582, -14725, 1142, // 356
	13740, -14598, 857, // 357
	13894, -14466, 571, // 358
	14043, -14329, 285, // 359
};

class WheelLookupTable {	
public:
	static void getSpeedsFromDirection(int direction, int &left, int &right, int &back) {
		const prog_int16_t* pointer = &wheelSpeeds[direction * 3];
		left = (int16_t)pgm_read_word(pointer);
		right = (int16_t)pgm_read_word(pointer+1);
		back = (int16_t)pgm_read_word(pointer+2);
	}

	static void getSinCosFromDirection(int direction, int &sin, int &cos) {
		const prog_int16_t* pointer = &wheelSpeeds[direction * 3];
		sin = (int16_t)-pgm_read_word(pointer+2);
		pointer = &wheelSpeeds[((direction + 270) % 360) * 3];
		cos = (int16_t)-pgm_read_word(pointer+2);
	}
};